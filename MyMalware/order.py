#!/usr/bin/env python3
"""
created: 2022-08-05 20:52:42
@author: seraphâ˜…776
contact: seraph776@gmail.com
project: Python Crash Course
license: MIT
metadoc: 
"""

# STEP 1: Import Libraries:
import os
from cryptography.fernet import Fernet

# STEP 2: Store all files in current directory in a list,
# except for the malicious script, and key:
files = [file for file in os.listdir('myPersonalData')]

# STEP 3: Open secret key using Fernet:
with open('balance.key', 'rb') as key_object:
    secret_key = key_object.read()


# STEP 4: Open each file in files, and decrypt
# using Fernet and generated key:
for file in files:
    path = os.path.join('myPersonalData', file)
    with open(path, 'rb') as fo:
        contents = fo.read()

    # Step 5: Decrypting each file using our crypt_key:
    decrypted_content = Fernet(secret_key).decrypt(contents)

    # STEP 6: Save decrypted data back to directory:
    with open(path, 'wb') as fo:
        fo.write(decrypted_content)
